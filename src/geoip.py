FLAGS = {
    "104.16.": "\U0001F1FA\U0001F1F8",
    "104.17.": "\U0001F1FA\U0001F1F8",
    "104.18.": "\U0001F1FA\U0001F1F8",
    "104.19.": "\U0001F1FA\U0001F1F8",
    "104.20.": "\U0001F1FA\U0001F1F8",
    "104.21.": "\U0001F1FA\U0001F1F8",
    "104.22.": "\U0001F1FA\U0001F1F8",
    "104.23.": "\U0001F1FA\U0001F1F8",
    "104.24.": "\U0001F1FA\U0001F1F8",
    "104.25.": "\U0001F1FA\U0001F1F8",
    "104.26.": "\U0001F1FA\U0001F1F8",
    "104.27.": "\U0001F1FA\U0001F1F8",
    "141.101.": "\U0001F1EA\U0001F1FA",
    "162.158.": "\U0001F1FA\U0001F1F8",
    "162.159.": "\U0001F1E9\U0001F1EA",
    "172.64.": "\U0001F1FA\U0001F1F8",
    "172.65.": "\U0001F1FA\U0001F1F8",
    "172.66.": "\U0001F1FA\U0001F1F8",
    "172.67.": "\U0001F1FA\U0001F1F8",
    "172.68.": "\U0001F1FA\U0001F1F8",
    "172.69.": "\U0001F1FA\U0001F1F8",
    "172.70.": "\U0001F1FA\U0001F1F8",
    "172.71.": "\U0001F1FA\U0001F1F8",
    "173.245.": "\U0001F1FA\U0001F1F8",
    "188.114.": "\U0001F1EA\U0001F1FA",
    "190.93.": "\U0001F1FA\U0001F1F8",
    "197.234.": "\U0001F1FA\U0001F1F8",
    "198.41.": "\U0001F1FA\U0001F1F8",
    "108.162.": "\U0001F1FA\U0001F1F8",
    "131.0.": "\U0001F1EA\U0001F1FA",
    "1.": "\U0001F1FA\U0001F1F8",
    "5.": "\U0001F1E9\U0001F1EA",
    "8.": "\U0001F1FA\U0001F1F8",
    "23.": "\U0001F1FA\U0001F1F8",
    "24.": "\U0001F1FA\U0001F1F8",
    "31.": "\U0001F1E9\U0001F1EA",
    "37.": "\U0001F1F3\U0001F1F1",
    "45.": "\U0001F1FA\U0001F1F8",
    "46.": "\U0001F1E9\U0001F1EA",
    "51.": "\U0001F1EC\U0001F1E7",
    "52.": "\U0001F1FA\U0001F1F8",
    "54.": "\U0001F1FA\U0001F1F8",
    "64.": "\U0001F1FA\U0001F1F8",
    "65.": "\U0001F1FA\U0001F1F8",
    "66.": "\U0001F1FA\U0001F1F8",
    "67.": "\U0001F1FA\U0001F1F8",
    "68.": "\U0001F1FA\U0001F1F8",
    "69.": "\U0001F1FA\U0001F1F8",
    "74.": "\U0001F1FA\U0001F1F8",
    "75.": "\U0001F1FA\U0001F1F8",
    "76.": "\U0001F1FA\U0001F1F8",
    "77.": "\U0001F1E9\U0001F1EA",
    "78.": "\U0001F1E9\U0001F1EA",
    "79.": "\U0001F1E9\U0001F1EA",
    "80.": "\U0001F1EC\U0001F1E7",
    "81.": "\U0001F1E9\U0001F1EA",
    "82.": "\U0001F1E9\U0001F1EA",
    "83.": "\U0001F1E9\U0001F1EA",
    "84.": "\U0001F1E9\U0001F1EA",
    "85.": "\U0001F1E9\U0001F1EA",
    "86.": "\U0001F1EB\U0001F1F7",
    "87.": "\U0001F1E9\U0001F1EA",
    "88.": "\U0001F1EB\U0001F1F7",
    "89.": "\U0001F1E9\U0001F1EA",
    "91.": "\U0001F1E9\U0001F1EA",
    "92.": "\U0001F1E9\U0001F1EA",
    "93.": "\U0001F1E9\U0001F1EA",
    "94.": "\U0001F1E9\U0001F1EA",
    "95.": "\U0001F1E9\U0001F1EA",
    "103.": "\U0001F1E6\U0001F1FA",
    "109.": "\U0001F1E9\U0001F1EA",
    "128.": "\U0001F1FA\U0001F1F8",
    "130.": "\U0001F1FA\U0001F1F8",
    "132.": "\U0001F1FA\U0001F1F8",
    "134.": "\U0001F1FA\U0001F1F8",
    "135.": "\U0001F1FA\U0001F1F8",
    "136.": "\U0001F1FA\U0001F1F8",
    "137.": "\U0001F1FA\U0001F1F8",
    "138.": "\U0001F1FA\U0001F1F8",
    "139.": "\U0001F1FA\U0001F1F8",
    "140.": "\U0001F1FA\U0001F1F8",
    "142.": "\U0001F1FA\U0001F1F8",
    "143.": "\U0001F1FA\U0001F1F8",
    "144.": "\U0001F1FA\U0001F1F8",
    "146.": "\U0001F1FA\U0001F1F8",
    "147.": "\U0001F1EF\U0001F1F5",
    "148.": "\U0001F1FA\U0001F1F8",
    "149.": "\U0001F1FA\U0001F1F8",
    "150.": "\U0001F1EF\U0001F1F5",
    "151.": "\U0001F1EA\U0001F1FA",
    "152.": "\U0001F1FA\U0001F1F8",
    "154.": "\U0001F1FA\U0001F1F8",
    "155.": "\U0001F1FA\U0001F1F8",
    "156.": "\U0001F1FA\U0001F1F8",
    "157.": "\U0001F1FA\U0001F1F8",
    "158.": "\U0001F1FA\U0001F1F8",
    "159.": "\U0001F1FA\U0001F1F8",
    "160.": "\U0001F1FA\U0001F1F8",
    "161.": "\U0001F1FA\U0001F1F8",
    "163.": "\U0001F1FA\U0001F1F8",
    "164.": "\U0001F1FA\U0001F1F8",
    "165.": "\U0001F1FA\U0001F1F8",
    "166.": "\U0001F1FA\U0001F1F8",
    "167.": "\U0001F1FA\U0001F1F8",
    "168.": "\U0001F1FA\U0001F1F8",
    "169.": "\U0001F1FA\U0001F1F8",
    "170.": "\U0001F1FA\U0001F1F8",
    "176.": "\U0001F1E9\U0001F1EA",
    "178.": "\U0001F1E9\U0001F1EA",
    "185.": "\U0001F1EA\U0001F1FA",
    "193.": "\U0001F1E9\U0001F1EA",
    "194.": "\U0001F1E9\U0001F1EA",
    "195.": "\U0001F1E9\U0001F1EA",
    "198.": "\U0001F1FA\U0001F1F8",
    "199.": "\U0001F1FA\U0001F1F8",
    "200.": "\U0001F1E7\U0001F1F7",
    "203.": "\U0001F1E6\U0001F1FA",
    "204.": "\U0001F1FA\U0001F1F8",
    "205.": "\U0001F1FA\U0001F1F8",
    "206.": "\U0001F1FA\U0001F1F8",
    "207.": "\U0001F1FA\U0001F1F8",
    "208.": "\U0001F1FA\U0001F1F8",
    "209.": "\U0001F1FA\U0001F1F8",
    "210.": "\U0001F1EF\U0001F1F5",
    "211.": "\U0001F1F0\U0001F1F7",
    "212.": "\U0001F1E9\U0001F1EA",
    "213.": "\U0001F1E9\U0001F1EA",
    "216.": "\U0001F1FA\U0001F1F8",
    "217.": "\U0001F1E9\U0001F1EA",
}


def get_flag(ip):
    if not ip or not ip[0].isdigit():
        return "\U0001F310"

    # Check specific ranges first (longer prefix = more accurate)
    parts = ip.split(".")
    if len(parts) >= 2:
        key3 = parts[0] + "." + parts[1] + "."
        if key3 in FLAGS:
            return FLAGS[key3]

    key1 = parts[0] + "."
    if key1 in FLAGS:
        return FLAGS[key1]

    return "\U0001F310"
